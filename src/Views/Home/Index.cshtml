@using System.Reflection;
<div class="jumbotron">
    <div class="container">
        <h1 class="display-4">Tracer</h1>
        @{
            var description = Assembly.GetExecutingAssembly().GetCustomAttribute<AssemblyDescriptionAttribute>()?.Description;
        }
        <p class="lead">@description</p>
        <p>Access from <code>@Context.Connection.RemoteIpAddress?.ToString()</code><span class="badge badge-secondary ml-2" id="spanStatus">Idle</span></p>
        <p><button class="btn btn-success btn-lg mt-4" id="startAllButton" onclick="startAll()" role="button">Start All Tests</button></p>
    </div>
</div>
<div class="container">
    <div class="row no-gutters">
        <div class="col-md-6 mt-3">
            <div class="card mb-2 tests-card h-100">
                <div class="card-body">
                    <h5 class="card-title">HTTP Lag</h5>
                    <p class="card-text">Your browser will send server a simple message and get a simple response. This number means the time it costs from request to response. The smaller the number, the better your network is.</p>
                    <div class="form">
                        <div class="form-group">
                            <label for="pinglagfilter">Log filter(ms)</label>
                            <input type="number" class="form-control" id="pinglagfilter" value="200">
                        </div>
                        <button class="btn btn-primary" id="pingbutton" onclick="ping()">Start Test</button>
                        <button class="btn btn-secondary" id="stop-pingbutton" onclick="stopPing()">Stop Test</button>
                    </div>
                    <p class="test-status mt-3"><kbd id="httpStatus" class="d-none"></kbd></p>
                    <p class="test-status"><kbd id="httpMax" class="d-none"></kbd></p>
                </div>
            </div>
        </div>
        <div class="col-md-6 mt-3">
            <div class="card mb-2 tests-card h-100">
                <div class="card-body">
                    <h5 class="card-title">HTTP Lag</h5>
                    <canvas id="httpChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6 mt-3">
            <div class="card mb-2 tests-card h-100">
                <div class="card-body">
                    <h5 class="card-title">Download Speed</h5>
                    <p class="card-text">Your browser will download a 1MB file from our server. From the time it starts and it gets the file, we will help you calculate your network downloading speed. The larger the number, the better your network is.</p>
                    <div class="form">
                        <div class="form-group">
                            <label for="speedlagfilter">Log filter(MB/s)</label>
                            <input type="number" class="form-control" id="speedlagfilter" value="0.7">
                        </div>
                        <button class="btn btn-primary" id="downloadbutton" onclick="download()">Start Test</button>
                        <button class="btn btn-secondary" id="stopdownloadbutton" onclick="stopDownload()">Stop Test</button>
                    </div>
                    <p class="test-status mt-3"><kbd id="downStatus" class="d-none"></kbd></p>
                    <p class="test-status"><kbd id="downMax" class="d-none"></kbd></p>
                </div>
            </div>
        </div>
        <div class="col-md-6 mt-3">
            <div class="card mb-2 tests-card h-100">
                <div class="card-body">
                    <h5 class="card-title">Download Speed</h5>
                    <canvas id="downloadChart"></canvas>
                </div>
            </div>
        </div>

        <div class="col-md-6 mt-3">
            <div class="card mb-2 tests-card h-100">
                <div class="card-body">
                    <h5 class="card-title">WebSocket Lag</h5>
                    <p class="card-text">This number means how much gap time between current server event and last server event. The number should be close to 100ms. More than 120ms or less than 90ms is not proper.</p>
                    <div class="form">
                        <div class="form-group">
                            <label for="wslagfilter">Log filter(ms)</label>
                            <input type="number" class="form-control" id="wslagfilter" value="300">
                        </div>
                        <button class="btn btn-primary" id="wsbutton" onclick="WsTest()">Start Test</button>
                        <button class="btn btn-secondary" id="stopwsbutton" onclick="stopWsTest()">Stop Test</button>
                    </div>
                    <p class="test-status mt-3"><kbd id="wsStatus" class="d-none"></kbd></p>
                    <p class="test-status"><kbd id="wsmax" class="d-none"></kbd></p>
                </div>
            </div>
        </div>
        <div class="col-md-6 mt-3">
            <div class="card mb-2 tests-card h-100">
                <div class="card-body">
                    <h5 class="card-title">WebSocket Lag</h5>
                    <canvas id="wsChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="container mt-4" id="functions">
    <div class="row no-gutters">
        <div class="col-sm-12 px-1">
            <div class="card mb-2 tests-card">
                <div class="card-body">
                    <h5 class="card-title">Bad requests log</h5>
                    <div class="table-responsive">
                        <table class="table table-striped table-hover table-sm" id="logTable">
                            <tr>
                                <th>Time</th>
                                <th>Trigger</th>
                                <th>Value</th>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>